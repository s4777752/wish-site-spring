# Apache configuration for proper HTTP status codes and SPA routing

RewriteEngine On

# Существующие статические файлы возвращают правильные статусы
RewriteRule ^robots\.txt$ /robots.txt [L]
RewriteRule ^sitemap\.xml$ /sitemap.xml [L]
RewriteRule ^favicon\.svg$ /favicon.svg [L]

# Только известные маршруты SPA перенаправляются на index.html с кодом 200
RewriteRule ^$ /index.html [L]
RewriteRule ^affirmation/?$ /index.html [L]
RewriteRule ^document/?$ /index.html [L]
RewriteRule ^test-document/?$ /index.html [L]
RewriteRule ^terms/?$ /index.html [L]

# Все остальные несуществующие страницы возвращают 404
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /404.html [L,R=404]

# Set proper headers for static files
<FilesMatch "\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$">
    Header set Cache-Control "public, max-age=31536000"
</FilesMatch>

# Ensure HTML files are not cached
<FilesMatch "\.html$">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires "0"
</FilesMatch>